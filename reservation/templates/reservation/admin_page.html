{% load static %}

<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Админка</title>
    <link href="{% static '/css/bootstrap.min.css' %}" rel="stylesheet"/>

</head>
<body>
{% include 'reservation/includes/top_menu.html' %}
<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="bi bi-speedometer2 me-2"></i> Панель управления</h2>
            <p class="text-muted">Добро пожаловать, {{ user.email }}! Сегодня {% now "j F Y" %}</p>
        </div>
    </div>

    <!-- Статистика -->
    <div class="row mb-4">
        <div class="col-md-4 mb-3">
            <div class="card h-100 stat-card bg-reservations">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="card-title text-muted">Общие количество бронирований</h5>
                            <h2 class="mb-0">{{ data.reservations_count }}</h2>
                        </div>
                        <div class="icon-stat bg-purple">
                            <i class="bi bi-calendar-check fs-1 text-purple"></i>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a href="{% url 'reservation:reservation_list' %}" class="btn btn-sm btn-outline-purple">
                            Управление бронирования<i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-3">
            <div class="card h-100 stat-card bg-tables">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="card-title text-muted">Количество столиков</h5>
                            <h2 class="mb-0">{{ data.tables_count }}</h2>
                        </div>
                        <div class="icon-stat bg-orange">
                            <i class="bi bi-table fs-1 text-orange"></i>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a href="{% url 'reservation:table_list' %}" class="btn btn-sm btn-outline-orange">
                            Управление столиками<i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-3">
            <div class="card h-100 stat-card bg-users">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h5 class="card-title text-muted">Количество зарегистрированных пользователей</h5>
                            <h2 class="mb-0">{{ data.users_count }}</h2>
                        </div>
                        <div class="icon-stat bg-teal">
                            <i class="bi bi-people fs-1 text-teal"></i>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a href="{% url 'users:user_list' %}" class="btn btn-sm btn-outline-teal">
                            Управление пользователями<i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Основной контент -->
    <div class="row">
        <!-- Последние бронирования -->
        <div class="col-lg-8 mb-4">
            <div class="card dashboard-card">
                <div class="card-header bg-white">
                    <h5 class="mb-0"><i class="bi bi-clock-history me-2"></i> Последние бронирования</h5>
                </div>
                <div class="card-body recent-orders">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Дата</th>
                                    <th>Столик</th>
                                    <th>Количество гостей</th>
                                    <th>Гость</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for reservation in data.recent_reservations %}
                                <tr>
                                    <td>{{ reservation.id }}</td>
                                    <td>{{ reservation.date_reservation|date:"d.m.Y" }} {{ reservation.time_reservation|time:"H:i" }}</td>
                                    <td>№{{ reservation.table.table_number }}</td>
                                    <td>№{{ reservation.count_people }}</td>
                                    <td>{{ reservation.customer.email }}</td>
                                    <td>
                                    <a href="{% url 'reservation:reservation_update' reservation.pk %}" class="btn btn-sm btn-outline-primary">
                                            Редактировать
                                        </a>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="6" class="text-center">Нет последних бронирований</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer bg-white">
                    <a href="{% url 'reservation:reservation_list' %}" class="btn btn-sm btn-primary">
                        Все бронирования <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- Быстрые действия -->
        <div class="col-lg-4 mb-4">
            <div class="card dashboard-card">
                <div class="card-header bg-white">
                    <h5 class="mb-0"><i class="bi bi-lightning me-2"></i> Быстрые действия</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{% url 'reservation:reservation_create' %}" class="btn btn-outline-primary text-start">
                            <i class="bi bi-plus-circle me-2"></i> Добавить бронирование
                        </a>
                        <a href="{% url 'reservation:table_create' %}" class="btn btn-outline-secondary text-start">
                            <i class="bi bi-plus-square me-2"></i> Добавить столик
                        </a>
                    </div>
                </div>
            </div>


{% block footer %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12 text-center text-muted small">
            <p>Админ-панель ресторана "Сладкая жизнь" &copy; {% now "Y" %}</p>
        </div>
    </div>
</div>
{% endblock %}
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
</body>
</html>